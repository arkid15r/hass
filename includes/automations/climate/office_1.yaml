- id: office_1_heating_mat
  alias: Office 1 Heating Mat
  trigger:
    - platform: state
      entity_id: binary_sensor.office_1_motion_15m
    - platform: state
      entity_id: binary_sensor.office_1_motion
  condition:
    - condition: time
      after: '08:00:00'
      before: '20:00:00'
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_1_motion_15m
              state: 'on'
          sequence:
            - scene: scene.office_1_heating_mat_on
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_1_motion_15m
              state: 'off'
          sequence:
            - scene: scene.office_1_heating_mat_off

- id: office_1_humidifier
  alias: Office 1 Humidifier
  trigger:
    - platform: time_pattern
      minutes: /15
  condition:
    - condition: state
      entity_id: binary_sensor.office_1_windows
      state: 'off'
    - condition: time
      after: input_datetime.alarm_time_off
      before: input_datetime.alarm_time_on
  action:
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: sensor.office_1_humidity
              below: 55
          sequence:
            - scene: scene.office_1_humidifier_on
        - conditions:
            - condition: numeric_state
              entity_id: sensor.office_1_humidity
              above: 60
          sequence:
            - scene: scene.office_1_humidifier_off

- id: office_1_humidifier_on_windows_state
  alias: Office 1 Humidifier On Windows State
  trigger:
    - platform: state
      entity_id: binary_sensor.office_1_windows
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_1_windows
              state: 'on'
          sequence:
            - scene: scene.office_1_humidifier_off
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_1_windows
              state: 'off'
              for:
                seconds: 10
          sequence:
            - scene: scene.office_1_humidifier_on
