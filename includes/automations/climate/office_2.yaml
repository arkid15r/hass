- id: office_2_fan
  alias: Office 2 Fan
  trigger:
    - platform: state
      entity_id: binary_sensor.office_2_motion
    - platform: state
      entity_id: binary_sensor.office_2_motion_15m
  action:
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: sensor.office_2_temperature
              above: input_number.office_2_temperature_high
            - condition: state
              entity_id: binary_sensor.office_2_motion_15m
              state: 'on'
            - condition: state
              entity_id: binary_sensor.quite_time
              state: 'off'
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_fan_on
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_2_motion_15m
              state: 'off'
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_fan_off

- id: office_2_humidifier
  alias: Office 2 Humidifier
  trigger:
    - platform: numeric_state
      entity_id: sensor.office_2_humidity
      above: input_number.office_1_humidity_high
    - platform: numeric_state
      entity_id: sensor.office_2_humidity
      below: input_number.office_1_humidity_low
  condition:
    - condition: state
      entity_id: binary_sensor.office_2_window
      state: 'off'
    - condition: state
      entity_id: binary_sensor.quite_time
      state: 'off'
  action:
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: sensor.office_2_humidity
              above: input_number.office_1_humidity_high
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_humidifier_off
        - conditions:
            - condition: numeric_state
              entity_id: sensor.office_2_humidity
              below: input_number.office_1_humidity_low
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_humidifier_on

- id: office_2_humidifier_on_window_state
  alias: Office 2 Humidifier On Window State
  trigger:
    - platform: state
      entity_id: binary_sensor.office_2_window
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_2_window
              state: 'on'
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_humidifier_off
        - conditions:
            - condition: state
              entity_id: binary_sensor.office_2_window
              state: 'off'
              for:
                seconds: 10
          sequence:
            - service: scene.turn_on
              target:
                entity_id: scene.office_2_humidifier_on
